<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%><%String path = request.getContextPath();String basePath = request.getScheme()+"://"+request.getServerName()+":"+request.getServerPort()+path+"/";%><%@taglib prefix="s" uri="/struts-tags" %> <%@taglib prefix="pg" uri="http://jsptags.com/tags/navigation/pager" %><%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %> <!DOCTYPE html><html><head lang="en">    <title >尤克里里小站曲谱</title>    <link rel="stylesheet" href="<%=path %>/show/css/app.css" />    <link  href="<%=path %>/show/css/bootstrap-modal.css" rel="stylesheet"/>    <link href="<%=path %>/show/css/bootstrap-modal-bs3patch.css" rel="stylesheet"/>    <style type="text/css">    	.music_info .box-body .ms .musicOperate li{ width:20%}    	.music_info .box-body .ms .musicOperate li:FIRST-CHILD{    		width:40%;    	}    </style></head><body>    <!-- .container-->    <div class="container relative clearfix ">        <!-- article -->        <article class="music_info clear clearfix relative fl" >            <div class="clearfix">                    <header class="box-header clearfix">                        <p >尤克里里曲谱<span class="icon10"></span><s:property value="#music.musicName"/></p>                    </header>                    <!-- article 开始-->                    <article class="box-body" >                       	                        <section class="clearfix ">                            <div class="aside_right fl ms" >                               <s:iterator value="#pager.objs" var="obj" status="st">		                   		<s:if test="#obj.obj.id==#current">		                   		<p class="ms_title"><s:property value="#obj.obj.musicName"/></p>                                <div class="clearfix aboutcreate">                                    <ul class="musicOperate clearfix">                                        <li class="fl">                                            <a href="javascript:void(0)">                                           <span class="icon1"></span>                                            <time datetime="<s:property value="#obj.obj.createdate"/>"><s:property value="#obj.obj.createdate"/></time>                                            </a>                                        </li>                                        <li class="fl">                                            <a href="javascript:void(0)"><span class="icon2"></span><span ><s:property value="#music.scanfcount"/></span></a>                                        </li>                                        <li class="fl">                                            <a href="javascript:void(0)"><span class="icon3"></span><span><s:property value="#music.comments.size()"/></span></a>                                        </li>                                        <li class="fl">                                            <a href="<%=path %>/music/showMusicList?pager.offset=0"><span class="icon4"></span><span>ukulele</span></a>                                        </li>                                    </ul>                                </div>                                <div class="music-content ">                                	<s:if test="#music.vediokey!=null&&#music.vediokey!=''">                                		<div class="text-center" style="margin-bottom:20px"><s:property value="#music.vedioTitle"/></div>                                		<div id="vedio1"  data-vedio="<s:property value="#music.vediokey"/>" >                                		                                   		</div>                                		<script type="text/javascript" src="http://player.youku.com/jsapi">											    player = new YKU.Player('vedio1',{																						        styleid: '0',																						        client_id: '8c28509b47e39218',																						        vid: '<%=request.getAttribute("aaa") %>'																						    });																																	</script>                                	</s:if>                                	                                    <div class="music_con text-center">                                        <s:property value="#obj.obj.vedioCount" escapeHtml="false"/>                                    </div>									                                    <div class="music_pic text-center">                                        <s:iterator value="#obj.picsrc" var="ps">                                        	<img src=" <s:property value="#ps" />"  alt="尤克里里曲谱  尤克里里教程" data-bind="share"  data-title="这是一个ukulele曲谱"   >                                        </s:iterator>                                                                            </div>                                    <div class="ms_footer">                                        <p> 标签：&nbsp; <a href="<%=path %>/music/showMusicList?pager.offset=0">ukulele谱</a> &nbsp; <a href="<%=path %>/music/showMusicList?pager.offset=0">尤克里里谱</a> &nbsp; <a href="<%=path %>/music/showMusicList?pager.offset=0">尤克里里曲谱</a></p>                                    </div>                                </div>		                   		</s:if>		                   		</s:iterator>                                                                <div class="sharemusic">                                    <ul class="share-wrapper clearfix">                                        <li class="icn fl"><a href="#" class="share01" ></a> </li>                                        <li class="icn fl"><a href="#" class="share02" ></a> </li>                                        <li class="icn fl"><a href="#" class="share03" ></a> </li>                                        <li class="icn fl"><a href="#" class="share04" ></a> </li>                                        <li class="icn fl"><a href="#" class="share05" ></a> </li>                                        <li class="icn fl"><a href="#" class="share06" ></a> </li>                                        <li class="icn fl"><a href="#" class="share07" ></a> </li>                                    </ul>                                </div>                            </div>                        </section>                    </article>                    <footer class="footer_comments">                        <div class="ms_comment">                            <div class="clearfix">                        		<s:iterator value="#pager.objs" var="obj" status="st">                        		                       			<s:if test="#obj.obj.id==#current">                   				<s:if test="#st.index!=0">                   				<a href="<%=path %>/music/show?music.id=<s:property value="#pager.objs.get(#st.index-1).obj.id" />" class="prev"> <img src="<%=path %>/show/img/left.png" /></a>                   				</s:if>                       			<s:if test="#st.index!=#pager.objs.size()">                           		<a href="<%=path %>/music/show?music.id=<s:property value="#pager.objs.get(#st.index+1).obj.id" />" class="next"> <img src="<%=path %>/show/img/right.png" /></a>                   				</s:if>                   				<section class="fl active">                   				                                   <a href="<%=path %>/music/show?music.id=<s:property value="#obj.obj.id" />" class="musicImg" ><img alt="<s:property value="#obj.obj.musicName"/>" src="<s:property value="#obj.obj.smallSrc"/>"></a>                                   <a href="<%=path %>/music/show?music.id=<s:property value="#obj.obj.id" />" class="musicTitile"><s:property value="#obj.obj.musicName"/></a>                               </section>                       			</s:if>                       			                       			<s:else>                       				<section class="fl">                       					                                   <a href="<%=path %>/music/show?music.id=<s:property value="#obj.obj.id" />" class="musicImg"><img src='<s:property value="#obj.obj.smallSrc"/>'></a>	                                   <a href="<%=path %>/music/show?music.id=<s:property value="#obj.obj.id" />" class="musicTitile"><s:property value="#obj.obj.musicName"/></a>	                               </section>                       			</s:else>                           		                         		</s:iterator>                              	                                                              <%--  <section class="fl active">                                    <a href="#" class="musicImg"><img src="<%=path %>/show/img/qupu/1.png"></a>                                    <a href="#" class="musicTitile">发如雪--周杰伦</a>                                </section> --%>                            </div>                                                    </div>                        <div class="clearfix ms_comments_detail">                            <p class="btn1"><span id="countComment" style="color: #ef3f36; margin: 0 4px;">0</span>条评论</p>                            <div class="uptodate comments_tetail " style="margin-right: 0">                                <script type="text/html" id="context">									<li class="sectionpart">                                        <div class="comments clearfix commentRemove">                                            <img class="fl commentsImg" src="<%=path %>/show/img/pictuew.png"/>                                            <div class="fl commentsObj " >                                                <p class="textOverflow commentName"><a href="#">方军</a></p>                                                <p class="textOverflow commentConetnt"><a href="#">夏威夷吉他也叫尤克里里 </a></p>                                                <ul class="clearfix commentsoperate">                                                    <li class="fl "><a href="javascript:void(0)"  >4小时前</a></li>                                                    <li class="fl"><a href="#"  class="replay">回复</a></li>                                                    <li class="fl"><a href="#" class="bs_popover" data-url="<%=path %>/comment/update_topCount" data-send="comment.id" >顶</a></li>                                                    <li class="fl"></li>													<li class="fr"><a href="javascript:void(0)" >1楼</a></li>                                                </ul>                                            </div>                                        </div>                                    </li>								</script>                                <ul id="commmentContext">                                                                                                         <li id="publicComment">                                        <div class="comments clearfix">                                            <img class="fl commentsImg" src="<%=path %>/show/img/pictuew.png"/>                                            <div class="fl commentsObj " >                                                <form action=""  method="post" id="submit" >                                                    <textarea name="comment.content" id="numsicContent" style="display: block"></textarea>                                                    <button type="button" class="btn" data-toggle="modal" data-target="#myModal"  > 发布 </button>                                                    <div id="myModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" >                                                        <div class="modal-header">                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                                                            <h4 class="modal-title" id="exampleModalLabel">临时昵称</h4>                                                        </div>                                                        <div class="modal-body">                                                            	昵称：<input type="text"  class="form-control"  placeholder="昵称" name="comment.name" required="required"  />                                                            <input type="hidden" id="musicid"  name="comment.music.id" value="<s:property value="#music.id"/>"  />                                                        </div>                                                        <div class="modal-footer">                                                            <button type="button" class="btn" data-dismiss="modal">关闭</button>                                                            <button type="submit" class="btn" >发送</button>                                                        </div>                                                    </div>                                                </form>                                            </div>                                        </div>                                    </li>                                </ul>                            </div>                        </div>                    </footer>            </div>        </article><!--/.article-->				<!-- .aside -->        <aside class="another">            <div class="uptodate topics">                <p class="clearfix"><span class="fl">热门论坛</span>&nbsp;<span class="icon5"></span>  <a href="<%=path %>/cart/pagerCart?pager.offset=0" class="fr">more&nbsp;<img src="<%=path %>/show/img/right.png" class="icon6" /></a></p>                <ul>                	<s:iterator value="#carts" var="ct" >                	<li class="clearfix"><a class="fl" href="<%=path %>/cart/show?cart.id=<s:property value="#ct.id" />"><s:property value="#ct.title" />--<s:property value="#ct.username" /></a></li>                	</s:iterator>                </ul>            </div>            <div class="uptodate topics comment " style="margin-right: 0">                <p class="clearfix"><span class="fl">评论留言</span>&nbsp; </p>                <ul>                	<s:iterator value="#comments" var="comment">               		<li>                        <div class="comments clearfix">                            <img class="fl commentsImg" src="<%=path %>/show/img/default.png"/>                            <div class="fl commentsObj " >                            	<s:if test="#comment.vedio!=null">                            	<p class="textOverflow clearfix"><a href="<%=path %>/vedio/show?vedio.id=<s:property value="#comment.vedio.id" />" class="fl"><s:property value="#comment.name" /></a> <span class="fr" ><s:property value="#comment.createDate"/></span> </p>                                <p class="textOverflow"><a href="<%=path %>/vedio/show?vedio.id=<s:property value="#comment.vedio.id" />"><s:property value="#comment.content" escapeHtml="false" /></a></p>	                            	</s:if>                                <s:elseif test="#comment.music!=null">                                <p class="textOverflow clearfix"><a href="<%=path %>/music/show?music.id=<s:property value="#comment.music.id" />" class="fl"><s:property value="#comment.name" /></a> <span class="fr" ><s:property value="#comment.createDate"/></span> </p>                                <p class="textOverflow"><a href="<%=path %>/music/show?music.id=<s:property value="#comment.music.id" />"><s:property value="#comment.content" escapeHtml="false" /></a></p>                                </s:elseif>                                <s:elseif test="#comment.cart!=null">                                <p class="textOverflow clearfix"><a href="<%=path %>/cart/show?cart.id=<s:property value="#comment.cart.id" />" class="fl"><s:property value="#comment.name" /></a> <span class="fr" ><s:property value="#comment.createDate"/></span> </p>                                <p class="textOverflow"><a href="<%=path %>/cart/show?cart.id=<s:property value="#comment.cart.id" />"><s:property value="#comment.content" escapeHtml="false" /></a></p>                                </s:elseif>                                <s:else>                                <p class="textOverflow clearfix"><a href="<%=path %>/music/ukuleleAbout" class="fl"><s:property value="#comment.name" /></a> <span class="fr" ><s:property value="#comment.createDate"/></span> </p>                            <p class="textOverflow"><a href="<%=path %>/music/ukuleleAbout"><s:property value="#comment.content" escapeHtml="false" /></a></p>                                </s:else>                            </div>                        </div>                     </li>                	</s:iterator>                </ul>            </div>            <s:iterator value="#vedios" var="vedio">            <div class="vdobj relative">                <strong class="clearfix">最热视频  <a href="<%=path %>/vedio/showVedioList?pager.offset=0" class="fr">more&nbsp;<img src="<%=path %>/show/img/right.png" class="icon6" /></a></strong>                <div class="vedioList clearfix relative">                    <section >                        <a href="<%=path %>/vedio/show?vedio.id=<s:property value="#vedio.obj.id" />"><img src="<s:property value="#vedio.obj.vedioPicSrc"/>" alt="这是一个视频" /></a>                        <p><a href="<%=path %>/vedio/show?vedio.id=<s:property value="#vedio.obj.id" />"><s:property value="#vedio.obj.vedioTitle"/></a></p>                    </section>                </div>            </div>            </s:iterator>        </aside><!--/.aside-->    </div><!-- /.conatiner -->        <script src="<%=path %>/show/js/jquery.min.js"></script>    <script src="<%=path %>/show/ckeditor/ckeditor.js"></script>    <script src="<%=path %>/show/js/boostrap-modal.js"></script>     <script src="<%=path %>/show/js/app.js"></script>         <!-- 验证 -->    <script type="text/javascript" src="<%=path %>/show/js/jquery-html5Validate.js"></script>		<script type="text/javascript">	  var edit1 = CKEDITOR.replace("comment.content",{          uiColor:"#f1f1f1",//#a9f5aa          toolbar :                  [['Smiley']]      });	  var iId = $("#musicid").val();			$("#submit").html5Validate(function(){	        var sUrl = "<%=path %>/comment/addAjax";	        $("#numsicContent").val(CKEDITOR.instances.numsicContent.getData());	        $.ajax({	        	url:sUrl,	        	data:$(this).serialize(),	        	type:"post",	        	success:function(msg){	        		reload(iId,0,true);	        	}	        });	        	      });	      $.testRemind.css = {	        color: "#fff",	        backgroundColor: "#f60",	        "z-index":"200000"	      };	      	      function reload(id,type,reload){	    	  var sUrl = "<%=path %>/Ajax/ajaxList";	    	  	    	  $.ajax({		        	url:sUrl,		        	data:"comment.music.id="+id+"&type="+type,		        	type:"post",		        	dataType:"json",		        	success:function(msg){		        		$(".commentRemove").remove();		        		if(reload)$(window.frames[0].document).find("body").html("");		        		$("#myModal").modal('hide');		        		$(".modal-backdrop").hide();		        		$("body").removeClass("modal-open");		        		$("#countComment").html(msg.length);		        		$(msg).each(function(index){		        			var br = $("#context")[0].innerHTML;			        		var $br = $(br);		        			$br.find(".commentName").html(this.name);		        			$br.find(".commentConetnt").html(this.content);		        			$br.find(".commentsoperate li").eq(0).find("a").html(dateConverter(this.createDate));		        			$br.find(".commentsoperate li").eq(2).find("a").data("send","comment.id="+this.id);		        			$br.find(".commentsoperate li").eq(4).find("a").html((index+1)+"楼");		        					        			$br.insertBefore("#publicComment");		        		});		        	}		        });	      }	      reload(iId,0);	      	      $( "body").on("click",".replay",function(e){	        	e.preventDefault();	        	var $this = $(this);	        	$(window).scrollTop($(document).height());	        	var index = $this.closest(".sectionpart").index()+1;	        	$(window.frames[0].document).find("body").html("<p ><span style='color:#999'>回复"+index+"楼：</span>&nbsp;</p>");	         });	      	      	      $( "#commmentContext").on("click",".bs_popover",function(e){	        	e.preventDefault();	        	 var $this = $(this);	        	 $.ajax({	        		 url:$(this).data("url"),	        		 data:$(this).data("send"),	        		 success:function(msg){	        			 $this.showPopover(msg+"成功");	        		 },	        		 error:function(e){	        			 $this.showPopover("操作失败");	        		 }	        	 });	         });	</script>        <script>        var $section = $(".musics section.music");        $($.map($section,function(oI){            if(($(oI).index()+1)%3==1){                return oI;            };        })).css('margin-left','0px');        +function(){            var _source,_sourceUrl,_showcount,_desc,_summary,_site,                    _title,                    _width = 600,                    _height = 600,                    _top = (screen.height-_height)/2,                    _left = (screen.width-_width)/2,                    _url,                    _pic ;            $(".share-wrapper").on("click",".share01",shareToSinaWB);            $(".share-wrapper").on("click",".share02",shareToQzone);            $(".share-wrapper").on("click",".share03",shareToTieba);            $(".share-wrapper").on("click",".share04",shareToDouban);            $(".share-wrapper").on("click",".share05",shareToQQwb);            $(".share-wrapper").on("click",".share06",shareToRenren);            $(".share-wrapper").on("click",".share07",shareToKaixin);            function shareToSinaWB(event){                event.preventDefault();                var _shareUrl = 'http://v.t.sina.com.cn/share/share.php?&appkey=895033136';     //真实的appkey，必选参数                _shareUrl += '&url='+ encodeURIComponent(_url||document.location);     //参数url设置分享的内容链接|默认当前页location，可选参数                _shareUrl += '&title=' + encodeURIComponent(_title||document.title);    //参数title设置分享的标题|默认当前页标题，可选参数                _shareUrl += '&source=' + encodeURIComponent(_source||'');                _shareUrl += '&sourceUrl=' + encodeURIComponent(_sourceUrl||'');                _shareUrl += '&content=' + 'utf-8';   //参数content设置页面编码gb2312|utf-8，可选参数                _shareUrl += '&pic=' + encodeURIComponent(_pic||'');  //参数pic设置图片链接|默认为空，可选参数                window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',top='+_top+',left='+_left+',toolbar=no,menubar=no,scrollbars=no, resizable=1,location=no,status=0');            }            //分享到QQ空间            function shareToQzone(event){                event.preventDefault();                var _shareUrl = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?';                _shareUrl += 'url=' + encodeURIComponent(_url||document.location);   //参数url设置分享的内容链接|默认当前页location                _shareUrl += '&showcount=' + _showcount||0;      //参数showcount是否显示分享总数,显示：'1'，不显示：'0'，默认不显示                _shareUrl += '&desc=' + encodeURIComponent(_desc||'分享的描述');    //参数desc设置分享的描述，可选参数                _shareUrl += '&summary=' + encodeURIComponent(_summary||'分享摘要');    //参数summary设置分享摘要，可选参数                _shareUrl += '&title=' + encodeURIComponent(_title||document.title);    //参数title设置分享标题，可选参数                _shareUrl += '&site=' + encodeURIComponent(_site||'');   //参数site设置分享来源，可选参数                _shareUrl += '&pics=' + encodeURIComponent(_pic||'');   //参数pics设置分享图片的路径，多张图片以＂|＂隔开，可选参数                window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',top='+_top+',left='+_left+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');            }            //分享到百度贴吧            function shareToTieba(event){                event.preventDefault();                var _shareUrl = 'http://tieba.baidu.com/f/commit/share/openShareApi?';                _shareUrl += 'title=' + encodeURIComponent(_title||document.title);  //分享的标题                _shareUrl += '&url=' + encodeURIComponent(_url||document.location);  //分享的链接                _shareUrl += '&pic=' + encodeURIComponent(_pic||'');    //分享的图片                window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',left='+_left+',top='+_top+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');            }            //分享到豆瓣            function shareToDouban(event){                event.preventDefault();                var _shareUrl = 'http://shuo.douban.com/!service/share?';                _shareUrl += 'href=' + encodeURIComponent(_url||location.href);    //分享的链接                _shareUrl += '&name=' + encodeURIComponent(_title||document.title);    //分享的标题                _shareUrl += '&image=' + encodeURIComponent(_pic||'');    //分享的图片                window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',left='+_left+',top='+_top+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');            }            //分享到腾迅微博            function shareToQQwb(event){                event.preventDefault();                var _shareUrl = 'http://v.t.qq.com/share/share.php?';                _shareUrl += 'title=' + encodeURIComponent(_title||document.title);    //分享的标题                _shareUrl += '&url=' + encodeURIComponent(_url||location.href);    //分享的链接                _shareUrl += '&appkey=5bd32d6f1dff4725ba40338b233ff155';    //在腾迅微博平台创建应用获取微博AppKey                _shareUrl += '&site=' + encodeURIComponent(_site||'');   //分享来源                _shareUrl += '&pic=' + encodeURIComponent(_pic||'');    //分享的图片，如果是多张图片，则定义var _pic='图片url1|图片url2|图片url3....'                window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',left='+_left+',top='+_top+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');            }//分享到人人网            function shareToRenren(event){                event.preventDefault();                var _shareUrl = 'http://share.renren.com/share/buttonshare.do?';                _shareUrl += 'link=' + encodeURIComponent(_url||location.href);   //分享的链接                _shareUrl += '&title=' + encodeURIComponent(_title||document.title);     //分享的标题                window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',left='+_left+',top='+_top+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');            }//分享到开心网            function shareToKaixin(event){                event.preventDefault();                var _shareUrl = 'http://www.kaixin001.com/rest/records.php?';                _shareUrl += 'url=' + encodeURIComponent(_url||location.href);    //分享的链接                _shareUrl += '&content=' + encodeURIComponent('分享的文字');    //需要分享的文字，当文字为空时，自动抓取分享网址的title                _shareUrl += '&pic=' + encodeURIComponent(_pic||'');     //分享的图片,多个使用半角逗号分隔                _shareUrl += '&showcount=0';    //是否显示分享数，显示：'1'，不显示：'0'                _shareUrl += '&style=11';      //显示的样式，必选参数                _shareUrl += '&aid=' + encodeURIComponent(_site||'');    //显示分享来源                window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',left='+_left+',top='+_top+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');            }            function shareToKaixin2(event){                event.preventDefault();                var _shareUrl = 'http://www.kaixin001.com/repaste/share.php?';                _shareUrl += 'rtitle=' + encodeURIComponent(_title||document.title);   //分享的标题                window.open(_shareUrl,'_blank','width='+_width+',height='+_height+',left='+_left+',top='+_top+',toolbar=no,menubar=no,scrollbars=no,resizable=1,location=no,status=0');            }         }();    </script></body></html>